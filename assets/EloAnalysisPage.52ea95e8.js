import{af as rt,r as I,aK as D,A as J,q as O,g as ct,o as Q,C as U,a as S,D as R,b as g,w as b,aL as Z,I as tt,G as N,d as u,K as et,ag as ut,ah as ft,c as H,H as X,N as P,F as ht,ai as dt,aj as mt}from"./index.cd101e71.js";import"./transform.80ade4f3.js";import{_ as gt,V as vt}from"./VTable.7d6d99be.js";import{t as B,h as pt,j as _t,d as W,s as V,e as xt,f as yt,C as wt,m as Y,g as K}from"./country-flag.esm.0325ad62.js";/* empty css                                                                         */import{V as bt,a as Mt}from"./VMain.beabaaf3.js";import{V as F}from"./VRow.a07312b4.js";function At(a,o){let n=0;if(o===void 0)for(let e of a)e!=null&&(e=+e)>=e&&++n;else{let e=-1;for(let t of a)(t=o(t,++e,a))!=null&&(t=+t)>=t&&++n}return n}function j(a,o){let n,e;if(o===void 0)for(const t of a)t!=null&&(n===void 0?t>=t&&(n=e=t):(n>t&&(n=t),e<t&&(e=t)));else{let t=-1;for(let l of a)(l=o(l,++t,a))!=null&&(n===void 0?l>=l&&(n=e=l):(n>l&&(n=l),e<l&&(e=l)))}return[n,e]}function kt(a){return a}var $t=Array.prototype,Et=$t.slice;function z(a){return()=>a}function Ct(a,o,n){let e;for(;;){const t=B(a,o,n);if(t===e||t===0||!isFinite(t))return[a,o];t>0?(a=Math.floor(a/t)*t,o=Math.ceil(o/t)*t):t<0&&(a=Math.ceil(a*t)/t,o=Math.floor(o*t)/t),e=t}}function Vt(a){return Math.max(1,Math.ceil(Math.log(At(a))/Math.LN2)+1)}function St(){var a=kt,o=j,n=Vt;function e(t){Array.isArray(t)||(t=Array.from(t));var l,v=t.length,r,p,_=new Array(v);for(l=0;l<v;++l)_[l]=a(t[l],l,t);var k=o(_),i=k[0],s=k[1],c=n(_,i,s);if(!Array.isArray(c)){const C=s,T=+c;if(o===j&&([i,s]=Ct(i,s,T)),c=pt(i,s,T),c[0]<=i&&(p=B(i,s,T)),c[c.length-1]>=s)if(C>=s&&o===j){const y=B(i,s,T);isFinite(y)&&(y>0?s=(Math.floor(s/y)+1)*y:y<0&&(s=(Math.ceil(s*-y)+1)/-y))}else c.pop()}for(var m=c.length,x=0,f=m;c[x]<=i;)++x;for(;c[f-1]>s;)--f;(x||f<m)&&(c=c.slice(x,f),m=f-x);var E=new Array(m+1),M;for(l=0;l<=m;++l)M=E[l]=[],M.x0=l>0?c[l-1]:i,M.x1=l<m?c[l]:s;if(isFinite(p)){if(p>0)for(l=0;l<v;++l)(r=_[l])!=null&&i<=r&&r<=s&&E[Math.min(m,Math.floor((r-i)/p))].push(t[l]);else if(p<0){for(l=0;l<v;++l)if((r=_[l])!=null&&i<=r&&r<=s){const C=Math.floor((i-r)*p);E[Math.min(m,C+(c[C]<=r))].push(t[l])}}}else for(l=0;l<v;++l)(r=_[l])!=null&&i<=r&&r<=s&&E[_t(c,r,0,m)].push(t[l]);return E}return e.value=function(t){return arguments.length?(a=typeof t=="function"?t:z(t),e):a},e.domain=function(t){return arguments.length?(o=typeof t=="function"?t:z([t[0],t[1]]),e):o},e.thresholds=function(t){return arguments.length?(n=typeof t=="function"?t:z(Array.isArray(t)?Et.call(t):t),e):n},e}function Tt(a,o,n){a=+a,o=+o,n=(t=arguments.length)<2?(o=a,a=0,1):t<3?1:+n;for(var e=-1,t=Math.max(0,Math.ceil((o-a)/n))|0,l=new Array(t);++e<t;)l[e]=a+e*n;return l}const lt=a=>(dt("data-v-ed9e9934"),a=a(),mt(),a),Pt=["height"],It={class:"axis"},Nt=["transform"],Rt=["transform"],Wt=["width","height","transform"],Ft=["transform"],jt={class:"tooltip rounded bg-grey-darken-2 pa-2",style:{position:"absolute","pointer-events":"none","font-size":"0.2em"}},zt={key:0,class:"container"},Bt={class:"v-row",nowrap:""},Dt={class:"v-col d-flex flex-column justify-center align-center",cols:"auto"},Ht={class:"d-flex justify-center mt-3"},Lt={class:"mt-2"},Gt={class:"v-col",cols:"auto"},Xt=lt(()=>u("td",null,"1v1",-1)),Yt=lt(()=>u("td",null,"team",-1)),Kt={__name:"AllProfilesChart",setup(a){const o=I(0),n=I(0),e={left:50,right:20,top:50,bottom:50},t=W(),l=W(),v=4,r="#aaa",p="green",_="red",k=D(),{getAllProfiles:i}=J(k),s=O(()=>i.value.length==0),c=300,m=100,x=I(!1),f=I(null),E=ct();return Q(()=>{const M=V("svg.all-profiles-chart");o.value=M.node().clientWidth,n.value=o.value;const C=M.select("g.xaxis"),T=M.select("g.yaxis"),y=xt(t),L=yt(l);t.range([0,o.value-e.left-e.right]),l.range([n.value-e.top-e.bottom,0]);const ot=M.select("g.points"),at=V("div.tooltip"),nt=function(){let h=Y(i.value,d=>d["1v1"].rating),A=K(i.value,d=>d["1v1"].rating),$=Y(i.value,d=>d.team.rating),w=K(i.value,d=>d.team.rating);h=Math.floor(h/100)*100,A=Math.ceil(A/100)*100,$=Math.floor($/100)*100,w=Math.ceil(w/100)*100,t.domain([h,A]),l.domain([$,w]),y.ticks(Math.floor((A-h)/100)+1),L.ticks(Math.floor((w-$)/100)+1),C.call(y).call(d=>d.selectAll(".tick line").attr("y2",-(n.value-e.top-e.bottom)).attr("stroke-opacity",.1)).call(d=>d.append("text").attr("class","label").attr("x",o.value-e.left-e.right).attr("y",0).attr("dy","3em").attr("text-anchor","end").style("fill","white").text("1v1 elo \u2192")).select(".domain").remove(),T.call(L).call(d=>d.selectAll(".tick line").attr("x2",o.value-e.left-e.right).attr("stroke-opacity",.1)).call(d=>d.append("text").attr("class","label").attr("x",-e.left+4).attr("y",0).attr("dy","-1.5em").attr("text-anchor","start").style("fill","white").text("team elo \u2191")).select(".domain").remove()},st=function(h){const{innerHeight:A,innerWidth:$}=window;let w,d;return h.clientX+c+50>$?w=h.pageX-c-20:w=h.pageX+10,h.clientY+m+50>A?d=h.pageY-m-20:d=h.pageY+10,{left:w,top:d}},it=function(){ot.selectAll("circle").data(i.value).enter().append("circle").attr("r",v).attr("cx",h=>h["1v1"].rating?t(h["1v1"].rating):t(1e3)).attr("cy",h=>h.team.rating?l(h.team.rating):l(1e3)).style("fill",r).style("cursor","pointer").on("mouseover",function(h,A){x.value=!0,f.value=A,V(this).attr("r",v+3).style("fill",_).raise();const{left:$,top:w}=st(h);at.transition().style("left",$+"px").style("top",w+"px")}).on("mouseout",function(h,A){V(this).attr("r",v).style("fill",r),x.value=!1}).on("mousedown",function(){V(this).style("fill",p)}).on("mouseup",function(){V(this).style("fill",_),E.push({name:"profilepage",params:{profileId:f.value.profile_id}}),k.activeNav="player"})},G=function(){nt(),it()};i.value.length>0&&G(),U(i,()=>{G()})}),(M,C)=>(S(),R(ht,null,[g(et,{width:"100%"},{default:b(()=>[g(Z,{title:"Elo Scatters"},{default:b(()=>[g(tt,{active:N(s),indeterminate:N(s),absolute:"",bottom:"",height:"4",color:"deep-purple-accent-4"},null,8,["active","indeterminate"])]),_:1}),(S(),R("svg",{class:"all-profiles-chart",width:"100%",height:n.value},[u("g",It,[u("g",{class:"xaxis",transform:`translate(${e.left}, ${n.value-e.bottom})`},null,8,Nt),u("g",{class:"yaxis",transform:`translate(${e.left}, ${e.top})`},null,8,Rt)]),u("rect",{class:"mousemove-trigger",x:"0",y:"0",width:o.value?o.value-e.left-e.right:0,height:n.value?n.value-e.top-e.bottom:0,transform:`translate(${e.left}, ${e.top})`,fill:"transparent"},null,8,Wt),u("g",{class:"points",transform:`translate(${e.left}, ${e.top})`},null,8,Ft)],8,Pt))]),_:1}),ut(u("div",jt,[f.value?(S(),R("div",zt,[u("div",Bt,[u("div",Dt,[g(gt,{steamId:f.value.steam_id,size:"50px"},null,8,["steamId"]),u("div",Ht,[f.value.country&&f.value.country!=="TW"?(S(),H(N(wt),{key:0,country:f.value.country,size:"small"},null,8,["country"])):X("",!0),u("span",Lt,P(f.value.name),1)])]),u("div",Gt,[g(vt,{class:"bg-transparent"},{default:b(()=>[u("tbody",null,[u("tr",null,[Xt,u("td",null,P(f.value["1v1"].rank?"#"+f.value["1v1"].rank:"--"),1),u("td",null,P(f.value["1v1"].rating?f.value["1v1"].rating:"--"),1)]),u("tr",null,[Yt,u("td",null,P(f.value.team.rank?"#"+f.value.team.rank:"--"),1),u("td",null,P(f.value.team.rating?f.value.team.rating:"--"),1)])])]),_:1})])])])):X("",!0)],512),[[ft,x.value]])],64))}},qt=rt(Kt,[["__scopeId","data-v-ed9e9934"]]),Jt={class:"axis"},Ot=["transform"],Qt=["transform"],Ut=u("g",null,null,-1),q={__name:"EloDistributionChart",props:["mode"],setup(a){const o=a,n=400,e=I(null),t={left:50,right:20,top:40,bottom:50},l=D(),v=J(l);let r;o.mode==="1v1"?r=v.getElos1v1:o.mode==="team"&&(r=v.getElosTeam),console.log(r);const p=O(()=>r.value.length===0),_=100,k=[];return Q(()=>{V(e.value);const i=e.clientWidth;let s,c;W().range([0,i-t.left-t.right]),W().range([n-t.top-t.bottom,0]);const m=St();U(r,()=>{console.log(r.value),o.mode==="1v1"?(s=Math.floor(l.getMin1v1Elo/100)*100,c=Math.ceil(l.getMax1v1Elo/100)*100):o.mode==="team"&&(s=Math.floor(l.getMinTeamElo/100)*100,c=Math.ceil(l.getMaxTeamElo/100)*100);const x=Tt(s,c,_);m.domain([s,c]).thresholds(x),k.value=m(r.value),console.log("bins are",k.value)})}),(i,s)=>(S(),H(et,{width:"100%"},{default:b(()=>[g(Z,{title:o.mode+" Elo Distribution"},{default:b(()=>[g(tt,{active:N(p),indeterminate:N(p),absolute:"",bottom:"",height:"4",color:"deep-purple-accent-4"},null,8,["active","indeterminate"])]),_:1},8,["title"]),(S(),R("svg",{class:"elo-distribution-chart",width:"100%",height:n,ref_key:"svgEle",ref:e},[u("g",Jt,[u("g",{class:"xaxis",transform:`translate(${t.left}, ${n-t.bottom})`},null,8,Ot),u("g",{class:"yaxis",transform:`translate(${t.left}, ${t.top})`},null,8,Qt)]),Ut],512))]),_:1}))}},se={__name:"EloAnalysisPage",setup(a){const o=D();return o.getActiveNav!=="eloAnalysis"&&(o.activeNav="eloAnalysis"),(n,e)=>(S(),H(bt,null,{default:b(()=>[g(Mt,null,{default:b(()=>[g(F,null,{default:b(()=>[g(q,{mode:"1v1"})]),_:1}),g(F,null,{default:b(()=>[g(q,{mode:"team"})]),_:1}),g(F,null,{default:b(()=>[g(qt)]),_:1})]),_:1})]),_:1}))}};export{se as default};
